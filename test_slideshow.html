<!DOCTYPE html>
<html>
  <head>
    <title>Test Slideshow Start</title>
  </head>
  <body>
    <h1>Test Slideshow Start</h1>
    <button onclick="testSlideshow()">Start Test Slideshow</button>
    <div id="status"></div>

    <script>
      function testSlideshow() {
        console.log("ðŸ§ª Testing slideshow start with mock panel data");

        // Mock panel data that matches the backend format
        const mockPanelData = {
          story_id: "test_story_123",
          event_type: "panel_processing_complete",
          data: {
            panel_number: 1,
            story_id: "test_story_123",
            panel_data: {
              panel_number: 1,
              image_url:
                "https://storage.googleapis.com/calmira-backend/stories/story_1063051/panel_01.png",
              tts_url:
                "https://storage.googleapis.com/calmira-backend/stories/story_1063051/tts_panel_01.mp3",
              music_url:
                "https://storage.googleapis.com/calmira-backend/stories/story_1063051/music_panel_01.mp3",
              dialogue_text: "Test panel dialogue",
            },
          },
        };

        // Simulate the frontend logic
        const panelNumber = mockPanelData.data?.panel_number || "X";
        console.log(`Panel ${panelNumber} completed! Assets generated.`);

        // Start slideshow as soon as first panel is ready
        if (panelNumber === 1 && mockPanelData.data?.panel_data) {
          const firstPanel = mockPanelData.data.panel_data;

          // Validate that we have the required data
          if (!firstPanel.image_url || !firstPanel.tts_url) {
            console.warn("Panel 1 missing required assets:", firstPanel);
            return;
          }

          const initialPanel = {
            id: "1",
            imageUrl: firstPanel.image_url,
            narrationUrl: firstPanel.tts_url,
            backgroundMusicUrl:
              firstPanel.music_url || "/src/assets/audio/background-music.mp3",
          };

          console.log("ðŸŽ¬ Starting slideshow with first panel!", initialPanel);
          document.getElementById("status").innerHTML = `
                    <h3>âœ… Slideshow would start with:</h3>
                    <p>Image: ${initialPanel.imageUrl}</p>
                    <p>Audio: ${initialPanel.narrationUrl}</p>
                    <p>Music: ${initialPanel.backgroundMusicUrl}</p>
                `;
        }
      }
    </script>
  </body>
</html>
